import './polyfills.server.mjs';
import{a as F,b as _}from"./chunk-VAF47YYR.mjs";import{b as B}from"./chunk-3KO5J4H6.mjs";import{b as y,c as p,d as C,e as x,i as E,k,m as L,q as T,r as I,s as H,t as z}from"./chunk-OYWWVCLD.mjs";import{Aa as A,H as q,Ha as n,Ia as o,Ja as c,M as w,N as R,Pb as D,Ra as h,Sa as j,Ub as O,ab as s,cb as G,na as a,oa as m,sc as V,ua as g,vc as P,wc as b,xc as S,ya as d,yc as U}from"./chunk-WYYCUWOI.mjs";import"./chunk-5XUXGTUW.mjs";var M=class i{constructor(r,t,e,l,u){this.fb=r;this.authService=t;this.tokenService=e;this.router=l;this.alertService=u;this.loginForm=this.fb.group({email:["",[p.required,p.email]],password:["",p.required]})}loginForm;isLoading=!1;files=[];submit(){this.loginForm.valid&&(this.isLoading=!0,this.authService.login(this.loginForm.value).subscribe({next:r=>{this.isLoading=!1,r.success?(this.tokenService.setToken(r.accessToken,r.refreshToken),this.tokenService.setUser(r.user),this.router.navigate(["/admin/dashboard"]),alert("Login Successfully"),this.alertService.successToast("Login Successfully")):this.alertService.errorToast("Invalid Credentials")},error:r=>{this.isLoading=!1,console.error("Login error:",r),this.alertService.errorToast("Server connection failed. Please try again later.")}}))}static \u0275fac=function(t){return new(t||i)(m(I),m(_),m(B),m(P),m(F))};static \u0275cmp=w({type:i,selectors:[["app-login"]],decls:29,vars:1,consts:[[1,"account-pages"],[1,"container"],[1,"row","justify-content-center"],[1,"col-md-8","col-lg-6","col-xl-5"],[1,"card","shadow-sm"],[1,"card-body","p-4"],[1,"text-center","w-75","m-auto"],["routerLinkActive","active","routerLink","/login"],["src","assets/images/logo.webp","alt","Task Hive Logo","height","200","width","250",1,"img-fluid","object-fit-contain"],[1,"text-muted","mb-4","mt-3"],["accept-charset","utf-8",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","loginEmail",1,"form-label"],["id","loginEmail","formControlName","email","type","email","placeholder","User name / Email","required","",1,"form-control"],["for","loginPassword",1,"form-label"],["id","loginPassword","formControlName","password","type","password","placeholder","Password","required","",1,"form-control"],[1,"d-grid"],["type","submit",1,"btn","btn-primary"],[1,"row","mt-3"],[1,"col-12","text-center"],["routerLink","forget-password",1,"text-white-50","ml-1",2,"color","black !important"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"a",7)(8,"span"),c(9,"img",8),o()(),n(10,"p",9),s(11,"Enter your email address and password to access admin panel."),o()(),n(12,"form",10),h("ngSubmit",function(){return e.submit()}),n(13,"div",11)(14,"label",12),s(15,"Email/Username:"),o(),c(16,"input",13),o(),n(17,"div",11)(18,"label",14),s(19,"Password:"),o(),c(20,"input",15),o(),n(21,"div",16)(22,"button",17),s(23,"Log In"),o()(),n(24,"div",18)(25,"div",19)(26,"p")(27,"a",20),s(28,"Forgot your password?"),o()()()()()()()()()()()),t&2&&(a(12),d("formGroup",e.loginForm))},dependencies:[E,y,C,x,T,k,L,b,S],styles:[".account-pages[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center}.object-fit-contain[_ngcontent-%COMP%]{object-fit:contain}@media (max-width: 767.98px){.account-pages[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:1rem}.text-center.w-75[_ngcontent-%COMP%]{width:100%!important}}"]})};function $(i,r){i&1&&(n(0,"small"),s(1,"New password is required"),o())}function ee(i,r){i&1&&(n(0,"small"),s(1,"Password must be at least 6 characters"),o())}function te(i,r){if(i&1&&(n(0,"div",25),g(1,$,2,0,"small",26)(2,ee,2,0,"small",26),o()),i&2){let t,e,l=j();a(),d("ngIf",(t=l.resetPasswordForm.get("newPassword"))==null||t.errors==null?null:t.errors.required),a(),d("ngIf",(e=l.resetPasswordForm.get("newPassword"))==null||e.errors==null?null:e.errors.minlength)}}function re(i,r){i&1&&(n(0,"small"),s(1,"Please confirm your password"),o())}function oe(i,r){i&1&&(n(0,"small"),s(1,"Passwords do not match"),o())}function ie(i,r){if(i&1&&(n(0,"div",25),g(1,re,2,0,"small",26)(2,oe,2,0,"small",26),o()),i&2){let t,e,l=j();a(),d("ngIf",(t=l.resetPasswordForm.get("confirmPassword"))==null||t.errors==null?null:t.errors.required),a(),d("ngIf",(e=l.resetPasswordForm.get("confirmPassword"))==null||e.errors==null?null:e.errors.passwordMismatch)}}function ne(i,r){i&1&&c(0,"span",27)}var N=class i{constructor(r,t,e,l,u){this.fb=r;this.authService=t;this.router=e;this.route=l;this.alertService=u;this.resetPasswordForm=this.fb.group({email:["",[p.required,p.email]],newPassword:["",[p.required,p.minLength(6)]],confirmPassword:["",[p.required]]},{validators:this.passwordMatchValidator}),this.route.queryParams.subscribe(f=>{this.resetToken=f.token||""})}resetPasswordForm;isLoading=!1;resetToken="";passwordMatchValidator(r){let t=r.get("newPassword"),e=r.get("confirmPassword");return t&&e&&t.value!==e.value?(e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):(e?.errors?.passwordMismatch&&(delete e.errors.passwordMismatch,Object.keys(e.errors).length===0&&e.setErrors(null)),null)}submit(){if(this.resetPasswordForm.valid){this.isLoading=!0;let r={newPassword:this.resetPasswordForm.get("newPassword")?.value,confirmPassword:this.resetPasswordForm.get("confirmPassword")?.value,email:this.resetPasswordForm.get("email")?.value};this.authService.resetPassword(r).subscribe({next:t=>{this.isLoading=!1,t.success?(this.alertService.successToast(t.msg||"Password updated successfully"),alert(t.msg||"Password updated successfully"),this.router.navigate(["/login"])):(this.alertService.errorToast(t.message||"Failed to update password"),alert(t.message||"Failed to update password"))},error:t=>{this.isLoading=!1,console.error("Password reset error:",t);let e="Server connection failed. Please try again later.";t.status===400?e=t.error?.error?.message||"Invalid request. Please check your input.":t.status===404&&(e="User not found."),this.alertService.errorToast(e),alert(e)}})}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.resetPasswordForm.controls).forEach(r=>{this.resetPasswordForm.get(r)?.markAsTouched({onlySelf:!0})})}static \u0275fac=function(t){return new(t||i)(m(I),m(_),m(P),m(V),m(F))};static \u0275cmp=w({type:i,selectors:[["app-forgetpassword"]],decls:36,vars:10,consts:[[1,"account-pages"],[1,"container"],[1,"row","justify-content-center"],[1,"col-md-8","col-lg-6","col-xl-5"],[1,"card","shadow-sm"],[1,"card-body","p-4"],[1,"text-center","w-75","m-auto"],["routerLinkActive","active","routerLink","/login"],["src","assets/images/logo.webp","alt","Task Hive Logo","height","200","width","250",1,"img-fluid","object-fit-contain"],[1,"text-muted","mb-4","mt-3"],["accept-charset","utf-8",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","loginEmail",1,"form-label"],["id","loginEmail","formControlName","email","type","email","placeholder","User name / Email","required","",1,"form-control"],["for","newPassword",1,"form-label"],["id","newPassword","formControlName","newPassword","type","password","placeholder","Enter new password","required","",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","confirmPassword",1,"form-label"],["id","confirmPassword","formControlName","confirmPassword","type","password","placeholder","Confirm new password","required","",1,"form-control"],[1,"d-grid"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],[1,"row","mt-3"],[1,"col-12","text-center"],["routerLink","/login",1,"text-decoration-none",2,"color","black !important"],[1,"invalid-feedback"],[4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(t,e){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"a",7)(8,"span"),c(9,"img",8),o()(),n(10,"p",9),s(11,"Enter your new password and confirm it to update your password."),o()(),n(12,"form",10),h("ngSubmit",function(){return e.submit()}),n(13,"div",11)(14,"label",12),s(15,"Email/Username:"),o(),c(16,"input",13),o(),n(17,"div",11)(18,"label",14),s(19,"New Password:"),o(),c(20,"input",15),g(21,te,3,2,"div",16),o(),n(22,"div",11)(23,"label",17),s(24,"Confirm Password:"),o(),c(25,"input",18),g(26,ie,3,2,"div",16),o(),n(27,"div",19)(28,"button",20),g(29,ne,1,0,"span",21),s(30),o()(),n(31,"div",22)(32,"div",23)(33,"p")(34,"a",24),s(35,"Back to Login"),o()()()()()()()()()()()),t&2){let l,u,f,v;a(12),d("formGroup",e.resetPasswordForm),a(8),A("is-invalid",((l=e.resetPasswordForm.get("newPassword"))==null?null:l.invalid)&&((l=e.resetPasswordForm.get("newPassword"))==null?null:l.touched)),a(),d("ngIf",((u=e.resetPasswordForm.get("newPassword"))==null?null:u.invalid)&&((u=e.resetPasswordForm.get("newPassword"))==null?null:u.touched)),a(4),A("is-invalid",((f=e.resetPasswordForm.get("confirmPassword"))==null?null:f.invalid)&&((f=e.resetPasswordForm.get("confirmPassword"))==null?null:f.touched)),a(),d("ngIf",((v=e.resetPasswordForm.get("confirmPassword"))==null?null:v.invalid)&&((v=e.resetPasswordForm.get("confirmPassword"))==null?null:v.touched)),a(2),d("disabled",e.resetPasswordForm.invalid||e.isLoading),a(),d("ngIf",e.isLoading),a(),G(" ",e.isLoading?"Updating...":"Update Password"," ")}},dependencies:[D,E,y,C,x,T,k,L,b,S],styles:[".account-pages[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center}.object-fit-contain[_ngcontent-%COMP%]{object-fit:contain}@media (max-width: 767.98px){.account-pages[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:1rem}.text-center.w-75[_ngcontent-%COMP%]{width:100%!important}}"]})};var K=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=R({type:i});static \u0275inj=q({imports:[O,z,H,U.forChild([{path:"",component:M},{path:"forget-password",component:N}])]})};export{K as LoginModule};
