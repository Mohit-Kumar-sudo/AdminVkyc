(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86051,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return o}});let o=e=>{}},53904,e=>{"use strict";var t=e.i(48277),r=e.i(30668),o=e.i(1831);let l=(0,r.createContext)(void 0);function a(e){try{let t=e.split(".");if(3!==t.length)return!0;let r=JSON.parse(atob(t[1])),o=Math.floor(Date.now()/1e3);return!!r.exp&&r.exp<o}catch(e){return!0}}function n(e){let{children:n}=e,[s,u]=(0,r.useState)(null),[i,c]=(0,r.useState)(null),[g,S]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(!i)return;let e=setInterval(()=>{a(i)&&(console.log("Token expired, logging out..."),h())},6e4);return()=>clearInterval(e)},[i]),(0,r.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&t&&(a(e)?(console.log("Stored token is expired, clearing..."),localStorage.removeItem("token"),localStorage.removeItem("user"),c(null),u(null)):(c(e),u(JSON.parse(t))))};return e(),S(!1),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);let d=async(e,t)=>{let{user:r,token:l}=(await o.authAPI.login(e,t)).data;u(r),c(l),localStorage.setItem("token",l),localStorage.setItem("user",JSON.stringify(r))},m=async(e,t,r,l,a)=>{let{user:n,token:s}=(await o.authAPI.register(e,t,r,l,a)).data;u(n),c(s),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(n))},I=async e=>{let{user:t,token:r}=(await o.authAPI.loginWithGoogle(e)).data;u(t),c(r),localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(t))},f=async e=>{let{user:t,token:r}=(await o.authAPI.registerWithGoogle(e)).data;u(t),c(r),localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(t))},h=()=>{u(null),c(null),localStorage.removeItem("token"),localStorage.removeItem("user")};return(0,t.jsx)(l.Provider,{value:{user:s,token:i,login:d,register:m,loginWithGoogle:I,registerWithGoogle:f,logout:h,isLoading:g},children:n})}function s(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>n,"useAuth",()=>s])}]);