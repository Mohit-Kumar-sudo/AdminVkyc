(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6907,e=>{"use strict";var t=e.i(48277),s=e.i(30668),a=e.i(18033),l=e.i(53904),r=e.i(96086);e.s(["default",0,()=>{let[e,n]=(0,s.useState)([]),[d,i]=(0,s.useState)(!0),[o,c]=(0,s.useState)(""),[x,u]=(0,s.useState)("ALL"),[m,h]=(0,s.useState)("ALL"),[g,p]=(0,s.useState)(""),[y,f]=(0,s.useState)(""),{user:b,token:j}=(0,l.useAuth)(),v=(0,r.useRouter)();(0,s.useEffect)(()=>{b&&j?"admin"!==b.role?v.push("/dashboard"):N():v.push("/login")},[b,j,x,m,g,y]);let N=async()=>{try{i(!0);let e=new URLSearchParams;"ALL"!==x&&e.set("status",x.toLowerCase()),"ALL"!==m&&e.set("provider",m.toLowerCase()),g&&e.set("from",g),y&&e.set("to",y),e.set("limit","200");let t=await a.default.get("".concat("https://smilify.ai/api","/admin/payments?").concat(e.toString()),{headers:{Authorization:"Bearer ".concat(j)}});n(t.data.payments||[])}catch(s){var e,t;console.error("Error fetching payments:",s),alert((null==s||null==(t=s.response)||null==(e=t.data)?void 0:e.error)||"Failed to fetch payments")}finally{i(!1)}},w=(0,s.useMemo)(()=>{if(!o)return e;let t=o.toLowerCase();return e.filter(e=>{var s,a,l,r,n,d,i,o,c,x;let u=(null==(a=e.userId)||null==(s=a.name)?void 0:s.toLowerCase())||"",m=(null==(r=e.userId)||null==(l=r.email)?void 0:l.toLowerCase())||"",h=(null==(i=e.subscriptionId)||null==(d=i.planId)||null==(n=d.name)?void 0:n.toLowerCase())||(null==(c=e.planId)||null==(o=c.name)?void 0:o.toLowerCase())||"",g=(null==(x=e.providerPaymentId)?void 0:x.toLowerCase())||"";return u.includes(t)||m.includes(t)||h.includes(t)||g.includes(t)})},[e,o]),L=(0,s.useMemo)(()=>{let e=w.length,t=w.filter(e=>"success"===e.status).length,s=w.filter(e=>"pending"===e.status).length;return{total:e,success:t,pending:s,failed:w.filter(e=>"failed"===e.status).length,refunded:w.filter(e=>"refunded"===e.status).length}},[w]);return d?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading transactions..."})]})}):(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Doctor Transactions"}),(0,t.jsx)("p",{className:"text-gray-600",children:"All payments made by doctors"})]}),(0,t.jsxs)("button",{onClick:N,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-all flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold mb-1",children:L.total}),(0,t.jsx)("div",{className:"text-blue-100",children:"Total"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold mb-1",children:L.success}),(0,t.jsx)("div",{className:"text-green-100",children:"Success"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold mb-1",children:L.pending}),(0,t.jsx)("div",{className:"text-yellow-100",children:"Pending"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold mb-1",children:L.failed}),(0,t.jsx)("div",{className:"text-red-100",children:"Failed"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-gray-500 to-gray-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold mb-1",children:L.refunded}),(0,t.jsx)("div",{className:"text-gray-100",children:"Refunded"})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[(0,t.jsx)("div",{className:"md:col-span-2",children:(0,t.jsx)("input",{type:"text",placeholder:"Search name, email, plan, payment id...",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 border border-gray-400 text-gray-900 placeholder-gray-500 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"})}),(0,t.jsxs)("select",{value:x,onChange:e=>u(e.target.value),className:"px-4 py-2 border border-gray-400 text-gray-900 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",children:[(0,t.jsx)("option",{value:"ALL",children:"All Status"}),(0,t.jsx)("option",{value:"success",children:"Success"}),(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"failed",children:"Failed"}),(0,t.jsx)("option",{value:"refunded",children:"Refunded"})]}),(0,t.jsxs)("select",{value:m,onChange:e=>h(e.target.value),className:"px-4 py-2 border border-gray-400 text-gray-900 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",children:[(0,t.jsx)("option",{value:"ALL",children:"All Providers"}),(0,t.jsx)("option",{value:"razorpay",children:"Razorpay"}),(0,t.jsx)("option",{value:"stripe",children:"Stripe"})]}),(0,t.jsxs)("div",{className:"md:col-span-2 flex flex-wrap gap-2",children:[(0,t.jsx)("input",{type:"date",value:g,onChange:e=>p(e.target.value),className:"w-full min-w-[140px] flex-1 px-3 py-2 border border-gray-400 text-gray-900 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"}),(0,t.jsx)("input",{type:"date",value:y,onChange:e=>f(e.target.value),className:"w-full min-w-[140px] flex-1 px-3 py-2 border border-gray-400 text-gray-900 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Date"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Doctor"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Plan"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Base Amount"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"GST (18%)"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Total Amount"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Status"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Provider"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-600",children:"Payment ID"})]})}),(0,t.jsx)("tbody",{className:"divide-y",children:0===w.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:9,className:"text-center py-10 text-gray-500",children:"No transactions found"})}):w.map(e=>{var s,a,l,r,n,d;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-700",children:(d=e.paymentDate||e.createdAt||null)?new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}),(0,t.jsxs)("td",{className:"px-6 py-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null==(s=e.userId)?void 0:s.name)||"-"}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:(null==(a=e.userId)?void 0:a.email)||"-"})]}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-700",children:(null==(r=e.subscriptionId)||null==(l=r.planId)?void 0:l.name)||(null==(n=e.planId)?void 0:n.name)||"-"}),(0,t.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900 font-semibold",children:[e.currency," ",(e.baseAmount||0).toFixed(2)]}),(0,t.jsxs)("td",{className:"px-6 py-4 text-sm text-green-600 font-semibold",children:[e.currency," ",(e.gstAmount||0).toFixed(2)]}),(0,t.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900 font-bold",children:[e.currency," ",e.amount.toFixed(2)]}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"success":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-700",children:e.provider}),(0,t.jsx)("td",{className:"px-6 py-4 text-xs text-gray-500",children:e.providerPaymentId})]},e._id)})})]})})})]})}])}]);