(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53904,e=>{"use strict";var t=e.i(48277),o=e.i(30668),r=e.i(1831);let l=(0,o.createContext)(void 0);function a(e){try{let t=e.split(".");if(3!==t.length)return!0;let o=JSON.parse(atob(t[1])),r=Math.floor(Date.now()/1e3);return!!o.exp&&o.exp<r}catch(e){return!0}}function n(e){let{children:n}=e,[s,i]=(0,o.useState)(null),[u,c]=(0,o.useState)(null),[g,S]=(0,o.useState)(!0);(0,o.useEffect)(()=>{if(!u)return;let e=setInterval(()=>{a(u)&&(console.log("Token expired, logging out..."),v())},6e4);return()=>clearInterval(e)},[u]),(0,o.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&t&&(a(e)?(console.log("Stored token is expired, clearing..."),localStorage.removeItem("token"),localStorage.removeItem("user"),c(null),i(null)):(c(e),i(JSON.parse(t))))};return e(),S(!1),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);let m=async(e,t)=>{let{user:o,token:l}=(await r.authAPI.login(e,t)).data;i(o),c(l),localStorage.setItem("token",l),localStorage.setItem("user",JSON.stringify(o))},d=async(e,t,o,l,a)=>{let{user:n,token:s}=(await r.authAPI.register(e,t,o,l,a)).data;i(n),c(s),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(n))},I=async e=>{let{user:t,token:o}=(await r.authAPI.loginWithGoogle(e)).data;i(t),c(o),localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(t))},h=async e=>{let{user:t,token:o}=(await r.authAPI.registerWithGoogle(e)).data;i(t),c(o),localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(t))},v=()=>{i(null),c(null),localStorage.removeItem("token"),localStorage.removeItem("user")};return(0,t.jsx)(l.Provider,{value:{user:s,token:u,login:m,register:d,loginWithGoogle:I,registerWithGoogle:h,logout:v,isLoading:g},children:n})}function s(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>n,"useAuth",()=>s])}]);