{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohitkumar/Documents/new/Dental/frontend/src/lib/api.ts"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api';\n\nexport const api = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\napi.interceptors.request.use(\n  (config) => {\n    if (typeof window !== 'undefined') {\n      const token = localStorage.getItem('token');\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    const status = error.response?.status;\n    const url: string = error.config?.url || '';\n\n    if (status === 401) {\n      // Allow login/register to surface API error messages without redirecting\n      const isAuthEndpoint = url.includes('/auth/login') || url.includes('/auth/register');\n      if (isAuthEndpoint) {\n        return Promise.reject(error);\n      }\n\n      if (typeof window !== 'undefined') {\n        const hasToken = !!localStorage.getItem('token');\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        // Avoid redirect loop if already on login\n        if (hasToken && window.location.pathname !== '/login') {\n          window.location.href = '/login';\n        }\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\nexport interface User {\n  id: string;\n  name: string;\n  email: string;\n  role: 'admin' | 'subadmin' | 'doctor';\n  client?: string;\n  permissions?: string[];\n}\n\nexport interface Patient {\n  _id: string;\n  name: string;\n  dob?: string;\n  age?: number;\n  email?: string;\n  contact?: string;\n  address?: string;\n  disease?: string;\n  history?: string;\n  prescription?: string;\n  images?: Array<{ filename: string; path: string }>;\n  beforeAfterImages?: Array<{ type: 'before' | 'after'; filename: string; path: string; treatmentDate?: string; notes?: string }>;\n  monthlyTreatments?: Array<MonthlyTreatment>;\n  testimonials?: Array<Testimonial>;\n  treatmentHistory?: string[];\n  nextAppointment?: { date: string; time: string };\n  lastVisit?: string;\n  doctor?: string;\n  client?: string;\n  createdAt: string;\n  updatedAt?: string;\n}\n\nexport interface MonthlyTreatment {\n  _id: string;\n  month: number;\n  year: number;\n  treatmentType: 'IMPLANTS' | 'SMILE DESIGNING' | 'TEETH WHITENING' | 'BRACES' | 'OTHER';\n  treatmentsPlan: string;\n  treatmentsCompleted?: string;\n  improvements?: string;\n  notes?: string;\n  nextSteps?: string;\n  recordedBy?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Testimonial {\n  _id: string;\n  rating: number;\n  feedback: string;\n  treatmentType: 'IMPLANTS' | 'SMILE DESIGNING' | 'TEETH WHITENING' | 'BRACES' | 'OTHER';\n  isPublished: boolean;\n  recordedBy?: string | { _id: string; name: string; email: string };\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Appointment {\n  _id: string;\n  patient: string;\n  doctor: string;\n  client?: string;\n  startAt: string;\n  endAt?: string;\n  status: 'scheduled' | 'completed' | 'cancelled' | 'no-show';\n  notes?: string;\n  createdAt: string;\n}\n\nexport interface DashboardSummary {\n  patientsCount: number;\n  upcomingAppointmentsCount: number;\n  recentPatients: Patient[];\n  upcomingAppointments: Appointment[];\n}\n\nexport const authAPI = {\n  login: (email: string, password: string) =>\n    api.post<{ user: User; token: string }>('/auth/login', { email, password }),\n  register: (name: string, email: string, password: string) =>\n    api.post<{ user: User; token: string }>('/auth/register', { name, email, password }),\n};\n\nexport const patientsAPI = {\n  list: (params?: { q?: string; doctorId?: string; clientId?: string }) =>\n    api.get<Patient[]>('/patients', { params }),\n  get: (id: string) => api.get<Patient>(`/patients/${id}`),\n  create: (data: FormData) => api.post<Patient>('/patients', data, {\n    headers: { 'Content-Type': 'multipart/form-data' },\n  }),\n  update: (id: string, data: FormData) => api.put<Patient>(`/patients/${id}`, data, {\n    headers: { 'Content-Type': 'multipart/form-data' },\n  }),\n  delete: (id: string) => api.delete(`/patients/${id}`),\n  addMonthlyTreatment: (id: string, data: Partial<MonthlyTreatment>) => \n    api.post<Patient>(`/patients/${id}/monthly-treatment`, data),\n  updateMonthlyTreatment: (patientId: string, recordId: string, data: Partial<MonthlyTreatment>) =>\n    api.put<Patient>(`/patients/${patientId}/monthly-treatment/${recordId}`, data),\n  deleteMonthlyTreatment: (patientId: string, recordId: string) =>\n    api.delete(`/patients/${patientId}/monthly-treatment/${recordId}`),\n};\n\nexport const appointmentsAPI = {\n  list: (params?: { type?: string; patientId?: string; status?: string }) =>\n    api.get<Appointment[]>('/appointments', { params }),\n  get: (id: string) => api.get<Appointment>(`/appointments/${id}`),\n  create: (data: any) => api.post<Appointment>('/appointments', data),\n  update: (id: string, data: any) => api.put<Appointment>(`/appointments/${id}`, data),\n  delete: (id: string) => api.delete(`/appointments/${id}`),\n};\n\nexport const dashboardAPI = {\n  summary: () => api.get<DashboardSummary>('/dashboard/doctor'),\n};\n\n// Admin: Clients\nexport interface Client { _id: string; name: string; email?: string; contact?: string; notes?: string }\n\nexport const clientsAPI = {\n  list: () => api.get<Client[]>('/clients'),\n  get: (id: string) => api.get<Client>(`/clients/${id}`),\n  create: (data: Partial<Client>) => api.post<Client>('/clients', data),\n  update: (id: string, data: Partial<Client>) => api.patch<Client>(`/clients/${id}`, data),\n  delete: (id: string) => api.delete(`/clients/${id}`),\n};\n\n// Admin: Users\nexport const usersAPI = {\n  list: (params?: { role?: 'admin'|'subadmin'|'doctor'; clientId?: string; q?: string }) => api.get<User[]>('/users', { params }),\n  create: (data: { name: string; email: string; password: string; role?: 'admin'|'subadmin'|'doctor'; client?: string }) => api.post('/users', data),\n  update: (id: string, data: Partial<{ role: User['role']; client: string; phone: string; name: string }>) => api.patch(`/users/${id}`, data),\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohitkumar/Documents/new/Dental/frontend/src/context/AuthContext.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { User, authAPI } from '@/lib/api';\n\ninterface AuthContextType {\n  user: User | null;\n  token: string | null;\n  login: (email: string, password: string) => Promise<void>;\n  register: (name: string, email: string, password: string) => Promise<void>;\n  logout: () => void;\n  isLoading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem('token');\n    const storedUser = localStorage.getItem('user');\n    if (storedToken && storedUser) {\n      setToken(storedToken);\n      setUser(JSON.parse(storedUser));\n    }\n    setIsLoading(false);\n  }, []);\n\n  const login = async (email: string, password: string) => {\n    const response = await authAPI.login(email, password);\n    const { user, token } = response.data;\n    setUser(user);\n    setToken(token);\n    localStorage.setItem('token', token);\n    localStorage.setItem('user', JSON.stringify(user));\n  };\n\n  const register = async (name: string, email: string, password: string) => {\n    const response = await authAPI.register(name, email, password);\n    const { user, token } = response.data;\n    setUser(user);\n    setToken(token);\n    localStorage.setItem('token', token);\n    localStorage.setItem('user', JSON.stringify(user));\n  };\n\n  const logout = () => {\n    setUser(null);\n    setToken(null);\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, token, login, register, logout, isLoading }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;AAHA;;;AAcA,MAAM,4BAAc,IAAA,8KAAa,EAA8B;AAExD,SAAS,aAAa,KAAqC;QAArC,EAAE,QAAQ,EAA2B,GAArC;;IAC3B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;kCAAC;YACR,MAAM,cAAc,aAAa,OAAO,CAAC;YACzC,MAAM,aAAa,aAAa,OAAO,CAAC;YACxC,IAAI,eAAe,YAAY;gBAC7B,SAAS;gBACT,QAAQ,KAAK,KAAK,CAAC;YACrB;YACA,aAAa;QACf;iCAAG,EAAE;IAEL,MAAM,QAAQ,OAAO,OAAe;QAClC,MAAM,WAAW,MAAM,+HAAO,CAAC,KAAK,CAAC,OAAO;QAC5C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,SAAS,IAAI;QACrC,QAAQ;QACR,SAAS;QACT,aAAa,OAAO,CAAC,SAAS;QAC9B,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;IAC9C;IAEA,MAAM,WAAW,OAAO,MAAc,OAAe;QACnD,MAAM,WAAW,MAAM,+HAAO,CAAC,QAAQ,CAAC,MAAM,OAAO;QACrD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,SAAS,IAAI;QACrC,QAAQ;QACR,SAAS;QACT,aAAa,OAAO,CAAC,SAAS;QAC9B,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;IAC9C;IAEA,MAAM,SAAS;QACb,QAAQ;QACR,SAAS;QACT,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IAC1B;IAEA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAO;YAAO;YAAU;YAAQ;QAAU;kBAC5E;;;;;;AAGP;GA7CgB;KAAA;AA+CT,SAAS;;IACd,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB"}}]
}